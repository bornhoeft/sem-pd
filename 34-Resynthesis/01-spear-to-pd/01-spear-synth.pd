#N canvas 345 38 880 817 12;
#X declare -path abs;
#X obj 475 742 dac~;
#X obj 475 694 catch~ sum-bus;
#X obj 58 462 bng 19 250 50 0 empty empty Start\ playback 0 -10 0 12 #00ff04 #000000 #000000;
#X obj 58 552 metro 10;
#X obj 58 510 tgl 17 0 empty end empty 17 7 0 10 #fcfcfc #000000 #000000 0 47800;
#X obj 59 114 openpanel;
#X obj 59 87 bng 19 250 50 0 empty empty Open\ analysis\ file 0 -10 0 12 #00ff04 #000000 #000000;
#X floatatom 58 199 5 0 0 1 partials - - 0;
#X floatatom 167 199 5 0 0 1 frame-count - - 0;
#X obj 167 224 s framecount;
#X msg 143 551 0;
#X floatatom 144 588 5 0 0 0 - - - 0;
#X obj 58 586 f;
#X obj 102 586 + 1;
#X obj 162 630 s time;
#X obj 327 325 vsl 15 101 0.25 4 1 1 empty empty empty 0 -9 0 10 #00ff04 #000000 #000000 7600 1;
#X obj 327 459 s fscale;
#X msg 327 298 1;
#X obj 327 276 loadbang;
#X floatatom 327 435 5 0 0 0 - - - 0;
#X symbolatom 59 142 0 0 0 0 - - - 0;
#X obj 178 482 s fadetime;
#X obj 623 292 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000;
#X obj 622 312 s allon;
#X obj 702 292 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000;
#X obj 702 312 s alloff;
#X obj 178 323 vsl 15 101 0.25 4 1 1 empty empty empty 0 -9 0 10 #00ff04 #000000 #000000 2500 1;
#X msg 178 296 1;
#X obj 178 274 loadbang;
#X floatatom 178 432 5 0 0 0 - - - 0;
#X obj 178 455 * 10;
#X text 472 674 Gather up audio outputs;
#X text 180 170 Read a SPEAR sinusoidal analysis file;
#X text 474 314 OSCILLATOR BANK;
#X text 58 28 Synthesize a sinusoidal analysis file (from SPEAR) with a bank of sinusoid oscillators., f 100;
#X obj 474 338 mypartial 0;
#X obj 474 358 mypartial 1;
#X obj 474 378 mypartial 2;
#X obj 474 398 mypartial 3;
#X obj 474 438 mypartial 5;
#X obj 474 458 mypartial 6;
#X obj 474 478 mypartial 7;
#X obj 474 498 mypartial 8;
#X obj 474 518 mypartial 9;
#X obj 474 538 mypartial 10;
#X obj 474 558 mypartial 11;
#X obj 474 578 mypartial 12;
#X obj 474 598 mypartial 13;
#X obj 474 618 mypartial 14;
#X obj 474 638 mypartial 15;
#X obj 660 338 mypartial 16;
#X obj 660 358 mypartial 17;
#X obj 660 378 mypartial 18;
#X obj 660 398 mypartial 19;
#X obj 660 418 mypartial 20;
#X obj 660 438 mypartial 21;
#X obj 660 458 mypartial 22;
#X obj 660 478 mypartial 23;
#X obj 660 498 mypartial 24;
#X obj 660 517 mypartial 25;
#X obj 660 538 mypartial 26;
#X obj 660 558 mypartial 27;
#X obj 660 578 mypartial 28;
#X obj 660 598 mypartial 29;
#X obj 660 618 mypartial 30;
#X obj 660 637 mypartial 31;
#X obj 474 418 mypartial 4;
#X obj 654 102 declare -path abs;
#N canvas 212 38 909 797 loadspearfile 0;
#X obj 48 244 list split 2;
#X obj 287 376 list split 3;
#X obj 308 465 unpack 0 1 2;
#X floatatom 212 523 5 0 0 0 - - - 0;
#X obj 143 521 f;
#X obj 176 522 + 1;
#X msg 212 493 0;
#X obj 48 335 list split 1;
#X obj 63 406 f;
#X floatatom 63 428 5 0 0 0 - - - 0;
#X obj 62 361 select partials-count;
#X obj 46 500 f;
#X floatatom 43 567 5 0 0 0 - - - 0;
#X obj 46 453 select frame-count;
#X obj 49 191 textfile;
#X msg 50 102 rewind;
#X obj 92 157 until;
#X obj 91 134 bang;
#X text 139 158 keep sending bangs until we hit EOF;
#X text 121 190 read a line;
#X text 145 560 time counter;
#X text 54 319 header vars;
#X obj 346 443 list;
#X text 303 480 index freq mag;
#X obj 287 398 trigger b b l;
#X obj 89 282 trigger l b;
#X obj 362 503 f;
#X obj 358 553 f;
#X msg 50 55 read \$1 cr;
#X msg 194 666 \; frqarray resize 0 \; frqarray resize \$1 \; magarray resize 0 \; magarray resize \$1 \;;
#X obj 362 527 tabwrite magarray;
#X obj 358 578 tabwrite frqarray;
#X obj 194 635 *;
#X text 191 745 Size arrays as npartials x frames;
#X obj 308 496 *;
#X text 489 579 values are written to entry index x frame-count + time;
#X obj 321 521 +;
#X text 142 245 First two items are either header fields or time and harmonic count, f 69;
#X text 389 441 iterate down list processing three items at a time;
#X obj 50 33 inlet;
#X obj 18 637 outlet;
#X obj 60 603 outlet;
#X text 69 639 partials-count;
#X text 106 603 frame-count;
#X obj 50 78 t b a;
#X obj 102 216 s fileread;
#X text 182 218 tell rest of patch that new file is read;
#X text 99 31 input is name of SPEAR analysis file to read;
#X text 130 53 instruct [textfile] to read it in \, with carriage return line breaks, f 67;
#X text 429 660 loadspearfile.pd;
#X text 430 690 2013-02-20 Dan Ellis dpwe@ee.columbia.edu;
#X text 430 675 Read in data file written by SPEAR;
#X text 298 358 Remaining items in data lines are triples of <idx frq mag>;
#X obj 57 526 print;
#X floatatom 82 384 5 0 0 0 - - - 0;
#X obj 540 495 table frqarray;
#X obj 540 518 table magarray;
#X text 660 511 Tables to hold data;
#X connect 0 0 7 0;
#X connect 0 1 25 0;
#X connect 1 0 24 0;
#X connect 1 1 22 1;
#X connect 2 0 34 0;
#X connect 2 1 27 1;
#X connect 2 2 26 1;
#X connect 3 0 4 1;
#X connect 3 0 36 1;
#X connect 4 0 5 0;
#X connect 5 0 3 0;
#X connect 6 0 3 0;
#X connect 7 0 10 0;
#X connect 7 0 13 0;
#X connect 7 1 54 0;
#X connect 8 0 9 0;
#X connect 9 0 32 1;
#X connect 9 0 40 0;
#X connect 10 0 8 0;
#X connect 11 0 12 0;
#X connect 11 0 53 0;
#X connect 12 0 32 0;
#X connect 12 0 34 1;
#X connect 12 0 41 0;
#X connect 13 0 11 0;
#X connect 13 0 6 0;
#X connect 14 0 0 0;
#X connect 14 1 16 1;
#X connect 14 1 45 0;
#X connect 15 0 14 0;
#X connect 15 0 17 0;
#X connect 16 0 14 0;
#X connect 17 0 16 0;
#X connect 22 0 1 0;
#X connect 24 0 22 0;
#X connect 24 1 26 0;
#X connect 24 1 27 0;
#X connect 24 2 2 0;
#X connect 25 0 1 0;
#X connect 25 1 4 0;
#X connect 26 0 30 0;
#X connect 27 0 31 0;
#X connect 28 0 44 0;
#X connect 32 0 29 0;
#X connect 34 0 36 0;
#X connect 36 0 31 1;
#X connect 36 0 30 1;
#X connect 39 0 28 0;
#X connect 44 0 15 0;
#X connect 44 1 14 0;
#X connect 54 0 8 1;
#X connect 54 0 11 1;
#X restore 58 170 pd loadspearfile;
#N canvas 237 275 419 141 credits 0;
#X text 30 37 2010-02-17 Dan Ellis dpwe@ee.columbia.edu;
#X restore 703 30 pd credits;
#X obj 183 656 r framecount;
#X obj 144 685 select;
#X obj 143 737 s end;
#X msg 143 709 0;
#X text 192 738 s to metro toggle;
#X text 213 629 Detect end \, r in mypartial;
#X text 191 585 update time point for oscillators \, r in mypartial \,, f 30;
#X text 177 505 time base scale \, r in mypartial, f 17;
#X text 319 481 frequency scale \, r in mypartial, f 16;
#X text 261 225 Overall number of analysis frames, f 62;
#X obj 623 183 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X msg 623 207 \; pd dsp \$1 \;;
#N canvas 353 391 443 205 SPEAR 0;
#X obj 50 125 pdcontrol;
#X msg 50 95 browse https://www.klingbeil.com/spear/;
#X text 50 39 SPEAR;
#X text 49 61 Sinusoidal Partial Editing Analysis and Resynthesis;
#X connect 1 0 0 0;
#X restore 716 65 pd SPEAR;
#X connect 1 0 0 0;
#X connect 1 0 0 1;
#X connect 2 0 4 0;
#X connect 2 0 10 0;
#X connect 3 0 12 0;
#X connect 4 0 3 0;
#X connect 5 0 20 0;
#X connect 6 0 5 0;
#X connect 8 0 9 0;
#X connect 10 0 11 0;
#X connect 11 0 13 0;
#X connect 11 0 14 0;
#X connect 11 0 71 0;
#X connect 12 0 11 0;
#X connect 13 0 12 1;
#X connect 15 0 19 0;
#X connect 17 0 15 0;
#X connect 18 0 17 0;
#X connect 19 0 16 0;
#X connect 20 0 68 0;
#X connect 22 0 23 0;
#X connect 24 0 25 0;
#X connect 26 0 29 0;
#X connect 27 0 26 0;
#X connect 28 0 27 0;
#X connect 29 0 30 0;
#X connect 30 0 21 0;
#X connect 30 0 3 1;
#X connect 68 0 7 0;
#X connect 68 1 8 0;
#X connect 70 0 71 1;
#X connect 71 0 73 0;
#X connect 73 0 72 0;
#X connect 80 0 81 0;
